(function(){var t,n=function(t,n){return function(){return t.apply(n,arguments)}},o=[].slice;window.HistoryWard=t=function(){function t(t){this.isBrutal=t,this.onPopState=n(this.onPopState,this),this.uid=0,this.position=0,window.addEventListener("popstate",this.onPopState)}return t.PUSHSTATE="pushstate",t.FORWARD="popstate:forward",t.BACKWARD="popstate:backword",t.one=null,t.start=function(n){return t.one?t.one:t.one=new t(n)},t.startBrutally=function(){return t.start(!0),History.prototype.pushStatePure=History.prototype.pushState,History.prototype.pushState=function(){var n,e;return n=1<=arguments.length?o.call(arguments,0):[],(e=t.one).pushState.apply(e,n)}},t.prototype.clean=function(t){return t},t.prototype.dispatch=function(t,n){return window.dispatchEvent(new n.constructor(t,this.clean(n)))},t.prototype.isBackward=function(t){var n;return null==(null!=(n=t.state)?n.historyWardUID:void 0)?!0:t.state.historyWardUID<this.position},t.prototype.onPopState=function(n){return n.preventDefault(),this.isBackward(n)?this.dispatch(t.BACKWARD,n):this.dispatch(t.FORWARD,n),this.shift(n)},t.prototype.pushState=function(n,o,e){var r;return null==n&&(n={}),(r=!window.dispatchEvent(new CustomEvent(t.PUSHSTATE,{cancelable:!0,cancelBubble:!0,bubbles:!0,detail:{state:n,title:o,url:e}})))?void 0:(n.historyWardUID=this.position=this.uid+=1,this.isBrutal?history.pushStatePure(n,o,e):history.pushState(n,o,e))},t.prototype.resume=function(){return window.addEventListener("popstate",this.onPopState)},t.prototype.shift=function(t){var n;return this.position=null!=(null!=(n=t.state)?n.historyWardUID:void 0)?t.state.historyWardUID:0},t.prototype.stop=function(){return window.removeEventListener("popstate",this.onPopState)},t}()}).call(this);